<div class="row justify-content-center">
    <% if can? :edit, @listing %>
        <%= link_to 'Edit', edit_listing_path(@listing), class: 'btn btn-success m-1' %>
        <%= link_to 'Delete', listing_path(@listing), method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-danger m-1' %>
    <% end %>
</div>

<div class="row">
    <div class="col-md justify-content-start">
    <% if @listing.images.attached? %>
        <% num = @listing.images.count - 1 %>
        <% if num > 0 %>
            <section class="carousel" aria-label="Gallery">
                <ol class="carousel__viewport">
                    <% (0..num).each do |img| %>
                        <li id=<%= "carousel__slide#{ img }" %> tabindex="0" class="carousel__slide">
                            <div class="carousel__snapper"></div>
                            <%= image_tag @listing.display_size(img), class: 'img-fluid' %>
                            <%= link_to '', "#carousel__slide#{img == num ? 0 : (img + 1)}", class: "carousel__prev", target: "_self" %>
                            <%= link_to '', "#carousel__slide#{img == 0 ? num : (img - 1)}", class: "carousel__next", target: "_self" %>
                        </li>
                    <% end %>
                </ol>
                <aside class="carousel__navigation">
                    <ol class="carousel__navigation-list">
                        <% (0..num).each do |img| %>
                            <li class="carousel__navigation-item">
                                <%= link_to "Go to slide #{ img }", "#carousel__slide#{ img }", class: 'carousel__navigation-button', target: "_self" %>
                            </li>
                        <% end %>
                    </ol>
                </aside>
            </section>
        <% else %>
            <%= image_tag @listing.display_size(0), class: 'img-fluid' %>
        <% end %>
<% else %>
    <%= image_tag user_avatar(User.find(@listing.user_id), 1200), class: 'img-fluid'  %>
<% end %>
    </div>

    <%# Copy %>
    <div class="col-md justify-content-start">
        <h1 class='display-3'><%= @listing.name %></h1>
        <h3>When</h3><p><%= @listing.time.to_formatted_s(:long_ordinal) %></p>
        <h3>Where</h3><p><%= @listing.location %></p>
        <h3>Why</h3><p><%= @listing.why %></p>
        <h3>Cost</h3><p><%= @listing.cost %></p>
        <h3>Summary</h3><p><%= @listing.summary %></p>
    </div>
</div>

<div class="row justify-content-start">
    <%= raw(@listing.description) %>
</div>